{% extends "base.html" %}

{% block title %}{{ problem.title }}{% endblock %}

{% block content %}
{% load static %}

<div class="problem-solving-container">
    <!-- Left Pane: Code Editor -->
    <div class="code-editor-container">
        <form method="POST" action="{% url 'problem_detail' problem.id %}" class="code-form">
            {% csrf_token %}
            
            <div class="language-selector">
                {{ form.language }}
            </div>
            <div class="code-editor">
                {{ form.code }}
            </div>

            <div class="input-actions-container">
                <div class="code-input-box">
                    {{ form.cinput }}
                </div>
                <div class="button-group">
                    <button type="submit" name="action" value="run" id="run-btn">run</button>
                    <button type="submit" name="action" value="testcase" id="ctestcase-btn">
                        <span class="svg-icon"></span>
                    </button>
                    <button type="submit" name="action" value="submit" id="submit-btn">submit</button>
                </div>
            </div>
        </form>

        <div class="output-section">
            {% if status %}
                <h3>Submission Status</h3>
                <pre class="output-box">{{ status }}</pre>
            {% endif %}
            {% if coutput %}
                <h3>Output</h3>
                <pre class="output-box">{{ coutput }}</pre>
            {% endif %}
            {% if cerror %}
                <h3>Error</h3>
                <pre class="output-box">{{ cerror }}</pre>
            {% endif %}
            {% if ai_feedback %}
                <h3>AI Feedback</h3>
                <pre class="output-box">{{ ai_feedback }}</pre>
            {% endif %}
        </div>
    </div>

    <!-- Right Pane: Problem Details -->
    <div class="problem-details-container">
        <h1>{{ problem.title }}</h1>
        <div class="problem-meta">
            <span class="difficulty difficulty-{{ problem.difficulty|lower }}">{{ problem.difficulty }}</span>
            <div class="tags">
                {% for tag in problem.tags_list %}
                    <span class="tag">#{{ tag }}</span>
                {% endfor %}
            </div>
        </div>
        <hr>
        <div class="problem-description">
            {{ problem.description|linebreaksbr }}
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
    {{ block.super }}
    <script src="{% static 'problem/js/problem_detail.js' %}"></script>
{% endblock %}

{% block styles %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'problem/css/problem_detail.css' %}">
{% endblock %}